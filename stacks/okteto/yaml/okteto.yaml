---
# Source: okteto-enterprise/templates/permissive-psp.yaml
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: "do-okteto-enterprise-permissive"
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: '*'
  labels:
    app.kubernetes.io/name: "do-okteto-enterprise-permissive"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
spec:
  privileged: true
  hostNetwork: true
  allowPrivilegeEscalation: true
  defaultAllowPrivilegeEscalation: true
  hostPID: true
  hostIPC: true
  runAsUser:
    rule: RunAsAny
  fsGroup:
    rule: RunAsAny
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  hostPorts:
  - min: 0
    max: 65535
  volumes:
  - '*'
  allowedCapabilities:
  - '*'
---
# Source: okteto-enterprise/templates/restrictive-psp.yaml
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: "do-okteto-enterprise-restrictive"
  annotations:
    apparmor.security.beta.kubernetes.io/allowedProfileNames: runtime/default
    apparmor.security.beta.kubernetes.io/defaultProfileName: runtime/default
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: docker/default
    seccomp.security.alpha.kubernetes.io/defaultProfileName: docker/default
  labels:
    app.kubernetes.io/name: "do-okteto-enterprise-restrictive"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
spec:
  privileged: false
  hostNetwork: false
  allowPrivilegeEscalation: false
  defaultAllowPrivilegeEscalation: false
  hostPID: false
  hostIPC: false
  runAsUser:
    rule: RunAsAny
  fsGroup:
    rule: RunAsAny
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  allowedHostPaths:
    - pathPrefix: "/var/okteto/bin"
      readOnly: true
  volumes:
  - hostPath
  - configMap
  - downwardAPI
  - emptyDir
  - persistentVolumeClaim
  - secret
  - projected
  allowedCapabilities:
  - '*'

---
# Source: okteto-enterprise/charts/nginx-ingress/templates/controller-poddisruptionbudget.yaml

apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    component: "controller"
    heritage: Tiller
    release: do
  name: do-nginx-ingress-controller
spec:
  selector:
    matchLabels:
      app: nginx-ingress
      release: do
      component: "controller"
  minAvailable: 1

---
# Source: okteto-enterprise/charts/nginx-ingress/templates/default-backend-poddisruptionbudget.yaml

apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    component: "default-backend"
    heritage: Tiller
    release: do
  name: do-nginx-ingress-default-backend
spec:
  selector:
    matchLabels:
      app: nginx-ingress
      release: do
      component: "default-backend"
  minAvailable: 1

---
# Source: okteto-enterprise/templates/secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: do-okteto-enterprise
  labels:
    app.kubernetes.io/name: "do-okteto-enterprise-secret"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
    app.kubernetes.io/component: "api"
    app.kubernetes.io/part-of: "okteto"
type: Opaque
data:
  githubClientSecret: ""

---
# Source: okteto-enterprise/charts/nginx-ingress/templates/controller-configmap.yaml

apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    component: "controller"
    heritage: Tiller
    release: do
  name: do-nginx-ingress-controller
data:
  custom-http-errors: 502,503
  enable-underscores-in-headers: "true"
  ignore-invalid-headers: "false"
  

---
# Source: okteto-enterprise/charts/cert-manager/charts/cainjector/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: do-cainjector
  namespace: "okteto"
  labels:
    app: cainjector
    chart: cainjector-v0.8.1
    release: do
    heritage: Tiller

---
# Source: okteto-enterprise/charts/cert-manager/charts/webhook/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: do-webhook
  namespace: "okteto"
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller

---
# Source: okteto-enterprise/charts/cert-manager/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: do-cert-manager
  namespace: "okteto"
  labels:
    app: cert-manager
    chart: cert-manager-v0.8.1
    release: do
    heritage: Tiller

---
# Source: okteto-enterprise/charts/nginx-ingress/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    heritage: Tiller
    release: do
  name: do-nginx-ingress
---
# Source: okteto-enterprise/templates/service-account.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: do-okteto-enterprise
  labels:
    app: do-okteto-enterprise
    chart: "okteto-enterprise-0.2.13"
    release: "do"
    heritage: "Tiller"
    
    dev.okteto.com/token: "PLACEHOLDER_VALUE"
    
  annotations:
    dev.okteto.com/super: "true"


---
# Source: okteto-enterprise/charts/cert-manager/charts/cainjector/templates/rbac.yaml
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRole
metadata:
  name: do-cainjector
  labels:
    app: cainjector
    chart: cainjector-v0.8.1
    release: do
    heritage: Tiller
rules:
  - apiGroups: ["certmanager.k8s.io"]
    resources: ["certificates"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["secrets"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["configmaps", "events"]
    verbs: ["*"]
  - apiGroups: ["admissionregistration.k8s.io"]
    resources: ["validatingwebhookconfigurations", "mutatingwebhookconfigurations"]
    verbs: ["*"]
  - apiGroups: ["apiregistration.k8s.io"]
    resources: ["apiservices"]
    verbs: ["*"]
---
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: do-cainjector
  labels:
    app: cainjector
    chart: cainjector-v0.8.1
    release: do
    heritage: Tiller
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: do-cainjector
subjects:
  - name: do-cainjector
    namespace: "okteto"
    kind: ServiceAccount
---
# Source: okteto-enterprise/charts/cert-manager/templates/rbac.yaml
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRole
metadata:
  name: do-cert-manager
  labels:
    app: cert-manager
    chart: cert-manager-v0.8.1
    release: do
    heritage: Tiller
rules:
  - apiGroups: ["certmanager.k8s.io"]
    resources: ["certificates", "certificates/finalizers", "issuers", "clusterissuers", "orders", "orders/finalizers", "challenges",  "challenges/finalizers"]
    verbs: ["*"]
  - apiGroups: [""]
    resources: ["configmaps", "secrets", "events", "services","pods"]
    verbs: ["*"]
  - apiGroups: ["extensions"]
    resources: ["ingresses", "ingresses/finalizers"]
    verbs: ["*"]
---
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: do-cert-manager
  labels:
    app: cert-manager
    chart: cert-manager-v0.8.1
    release: do
    heritage: Tiller
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: do-cert-manager
subjects:
  - name: do-cert-manager
    namespace: "okteto"
    kind: ServiceAccount
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: do-cert-manager-view
  labels:
    app: cert-manager
    chart: cert-manager-v0.8.1
    release: do
    heritage: Tiller
    rbac.authorization.k8s.io/aggregate-to-view: "true"
    rbac.authorization.k8s.io/aggregate-to-edit: "true"
    rbac.authorization.k8s.io/aggregate-to-admin: "true"
rules:
  - apiGroups: ["certmanager.k8s.io"]
    resources: ["certificates", "issuers"]
    verbs: ["get", "list", "watch"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: do-cert-manager-edit
  labels:
    app: cert-manager
    chart: cert-manager-v0.8.1
    release: do
    heritage: Tiller
    rbac.authorization.k8s.io/aggregate-to-edit: "true"
    rbac.authorization.k8s.io/aggregate-to-admin: "true"
rules:
  - apiGroups: ["certmanager.k8s.io"]
    resources: ["certificates", "issuers"]
    verbs: ["create", "delete", "deletecollection", "patch", "update"]

---
# Source: okteto-enterprise/charts/nginx-ingress/templates/clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRole
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    heritage: Tiller
    release: do
  name: do-nginx-ingress
rules:
  - apiGroups:
      - ""
    resources:
      - configmaps
      - endpoints
      - nodes
      - pods
      - secrets
    verbs:
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - nodes
    verbs:
      - get
  - apiGroups:
      - ""
    resources:
      - services
    verbs:
      - get
      - list
      - update
      - watch
  - apiGroups:
      - extensions
      - "networking.k8s.io" # k8s 1.14+
    resources:
      - ingresses
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - events
    verbs:
      - create
      - patch
  - apiGroups:
      - extensions
      - "networking.k8s.io" # k8s 1.14+
    resources:
      - ingresses/status
    verbs:
      - update
---
# Source: okteto-enterprise/templates/dev-cluster-role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: do-okteto-enterprise-psp
  labels:
    app.kubernetes.io/name: do-okteto-enterprise-psp
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
rules:
- apiGroups:
  - ""
  resources:
  - pods
  - pods/log
  - pods/exec
  - pods/attach
  - pods/portforward
  - configmaps
  - secrets
  - services
  - endpoints
  - events
  - persistentvolumeclaims
  - persistentvolumes
  - replicationcontrollers
  verbs:
  - '*'
- apiGroups:
  - metrics.k8s.io
  resources:
  - pods
  verbs:
  - get
  - list
- apiGroups:
  - autoscaling
  resources:
  - horizontalpodautoscalers
  verbs:
  - '*'
- apiGroups:
  - apps
  resources:
  - daemonsets
  - deployments
  - replicasets
  - statefulsets
  verbs:
  - '*'
- apiGroups:
  - batch
  resources:
  - cronjobs
  - jobs
  verbs:
  - '*'
- apiGroups:
  - extensions
  resources:
  - deployments
  - ingresses
  - replicasets
  verbs:
  - '*'
- apiGroups:
  - ""
  resources:
  - events
  - limitranges
  - namespaces
  - namespaces/status
  - resourcequotas
  - resourcequotas/status
  verbs:
  - get
  - list
- apiGroups:
  - policy
  resourceNames:
  - "do-okteto-enterprise-restrictive"
  resources:
  - podsecuritypolicies
  verbs:
  - use
---
# Source: okteto-enterprise/charts/cert-manager/charts/webhook/templates/rbac.yaml
### Webhook ###
---
# apiserver gets the auth-delegator role to delegate auth decisions to
# the core apiserver
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: do-webhook:auth-delegator
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:auth-delegator
subjects:
- apiGroup: ""
  kind: ServiceAccount
  name: do-webhook
  namespace: okteto

---

# apiserver gets the ability to read authentication. This allows it to
# read the specific configmap that has the requestheader-* entries to
# api agg
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: RoleBinding
metadata:
  name: do-webhook:webhook-authentication-reader
  namespace: kube-system
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: extension-apiserver-authentication-reader
subjects:
- apiGroup: ""
  kind: ServiceAccount
  name: do-webhook
  namespace: okteto

---

apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: do-webhook:webhook-requester
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller
rules:
- apiGroups:
  - admission.certmanager.k8s.io
  resources:
  - certificates
  - issuers
  - clusterissuers
  verbs:
  - create

---
# Source: okteto-enterprise/charts/nginx-ingress/templates/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    heritage: Tiller
    release: do
  name: do-nginx-ingress
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: do-nginx-ingress
subjects:
  - kind: ServiceAccount
    name: do-nginx-ingress
    namespace: okteto
---
# Source: okteto-enterprise/templates/rbac.yaml
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: do-okteto-enterprise-role-binding
  labels:
    app: do-okteto-enterprise
    chart: "okteto-enterprise-0.2.13"
    release: "do"
    heritage: "Tiller"
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: do-okteto-enterprise
  namespace: okteto
---
# Source: okteto-enterprise/charts/nginx-ingress/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: Role
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    heritage: Tiller
    release: do
  name: do-nginx-ingress
rules:
  - apiGroups:
      - ""
    resources:
      - namespaces
    verbs:
      - get
  - apiGroups:
      - ""
    resources:
      - configmaps
      - pods
      - secrets
      - endpoints
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - services
    verbs:
      - get
      - list
      - update
      - watch
  - apiGroups:
      - extensions
      - "networking.k8s.io" # k8s 1.14+
    resources:
      - ingresses
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - extensions
      - "networking.k8s.io" # k8s 1.14+
    resources:
      - ingresses/status
    verbs:
      - update
  - apiGroups:
      - ""
    resources:
      - configmaps
    resourceNames:
      - ingress-controller-leader-nginx
    verbs:
      - get
      - update
  - apiGroups:
      - ""
    resources:
      - configmaps
    verbs:
      - create
  - apiGroups:
      - ""
    resources:
      - endpoints
    verbs:
      - create
      - get
      - update
  - apiGroups:
      - ""
    resources:
      - events
    verbs:
      - create
      - patch
---
# Source: okteto-enterprise/templates/psp-rbac.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: "do-okteto-enterprise-internal"
  labels:
    app.kubernetes.io/name: "do-okteto-enterprise-internal"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
rules:
- apiGroups:
  - policy
  resourceNames:
  - "do-okteto-enterprise-permissive"
  resources:
  - podsecuritypolicies
  verbs:
  - use

---

apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: "do-okteto-enterprise-internal"
  labels:
    app.kubernetes.io/name: "do-okteto-enterprise-internal"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
subjects:
- kind: ServiceAccount
  name: "do-cainjector"
  namespace: okteto
- kind: ServiceAccount
  name: "do-cert-manager"
  namespace: okteto
- kind: ServiceAccount
  name: "do-nginx-ingress"
  namespace: okteto
- kind: ServiceAccount
  name: "do-webhook"
  namespace: okteto
- kind: ServiceAccount
  name: "do-okteto-enterprise"
  namespace: okteto
- kind: ServiceAccount
  name: "default"
  namespace: okteto
roleRef:
  kind: Role
  name: "do-okteto-enterprise-internal"
  apiGroup: rbac.authorization.k8s.io
---
# Source: okteto-enterprise/charts/nginx-ingress/templates/rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: RoleBinding
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    heritage: Tiller
    release: do
  name: do-nginx-ingress
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: do-nginx-ingress
subjects:
  - kind: ServiceAccount
    name: do-nginx-ingress
    namespace: okteto
---
# Source: okteto-enterprise/charts/cert-manager/charts/webhook/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: do-webhook
  namespace: "okteto"
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller
spec:
  type: ClusterIP
  ports:
  - name: https
    port: 443
    targetPort: 6443
  selector:
    app: webhook
    release: do

---
# Source: okteto-enterprise/charts/nginx-ingress/templates/controller-service.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    component: "controller"
    heritage: Tiller
    release: do
  name: do-nginx-ingress-controller
spec:
  clusterIP: ""
  ports:
    - name: http
      port: 80
      protocol: TCP
      targetPort: http
    - name: https
      port: 443
      protocol: TCP
      targetPort: https
  selector:
    app: nginx-ingress
    component: "controller"
    release: do
  type: "LoadBalancer"

---
# Source: okteto-enterprise/charts/nginx-ingress/templates/default-backend-service.yaml

apiVersion: v1
kind: Service
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    component: "default-backend"
    heritage: Tiller
    release: do
  name: do-nginx-ingress-default-backend
spec:
  clusterIP: ""
  ports:
    - name: http
      port: 80
      protocol: TCP
      targetPort: http
  selector:
    app: nginx-ingress
    component: "default-backend"
    release: do
  type: "ClusterIP"

---
# Source: okteto-enterprise/templates/api-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: "do-okteto-enterprise-api"
  labels:
    app.kubernetes.io/component: "api"
    app.kubernetes.io/part-of: "okteto"
    app.kubernetes.io/name: "do-okteto-enterprise-api"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
spec:
  type: ClusterIP
  ports:
    - port: 8080
      name: api
  selector:
    app.kubernetes.io/name: "do-okteto-enterprise-api"
    app.kubernetes.io/instance: do

---
# Source: okteto-enterprise/templates/frontend-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: "do-okteto-enterprise-frontend"
  labels:
    app.kubernetes.io/component: "frontend"
    app.kubernetes.io/part-of: "okteto"
    app.kubernetes.io/name: "do-okteto-enterprise-frontend"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
spec:
  type: ClusterIP
  ports:
    - port: 8080
      name: frontend
  selector:
    app.kubernetes.io/name: "do-okteto-enterprise-frontend"
    app.kubernetes.io/instance: do

---
# Source: okteto-enterprise/templates/webhook-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: "do-okteto-enterprise-mutation-webhook"
  labels:
    app.kubernetes.io/component: "webhook"
    app.kubernetes.io/part-of: "okteto"
    app.kubernetes.io/name: "do-okteto-enterprise-mutation-webhook"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
spec:
  type: ClusterIP
  ports:
    - port: 443
      name: webhook
      targetPort: 8443
  selector:
    app.kubernetes.io/name: "do-okteto-enterprise-mutation-webhook"
    app.kubernetes.io/instance: do

---
# Source: okteto-enterprise/templates/inotify-daemon.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: "do-okteto-enterprise-inotify"
  labels:
    app.kubernetes.io/name: "do-okteto-enterprise-inotify"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/component: "inotify"
    app.kubernetes.io/part-of: "okteto"
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: "do-okteto-enterprise-inotify"
      app.kubernetes.io/instance: do
  template:
    metadata:
      labels:
        app.kubernetes.io/name: "do-okteto-enterprise-inotify"
        app.kubernetes.io/instance: do
        app.kubernetes.io/component: "inotify"
        app.kubernetes.io/part-of: "okteto"
      annotations:
        app.kubernetes.io/version: "do-okteto-enterprise-0.2.13"
    spec:
      terminationGracePeriodSeconds: 0
      serviceAccountName: do-okteto-enterprise
      containers:
        - name: inotify
          image: okteto/bin:1.0.2
          securityContext:
            privileged: true
          command:
            - /bin/sh
            - -c
            - "cp /usr/local/bin/* /var/okteto/bin && echo 10048576 > /proc-aux/sys/fs/inotify/max_user_watches && tail -f /dev/null"
          volumeMounts:
          - mountPath: /proc-aux
            name: proc-volume
          - mountPath: /var/okteto/bin
            name: okteto-bin
      volumes:
      - name: proc-volume
        hostPath:
          path: /proc
      - name: okteto-bin
        hostPath:
          path: /var/okteto/bin        
---
# Source: okteto-enterprise/charts/cert-manager/charts/cainjector/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: do-cainjector
  namespace: "okteto"
  labels:
    app: cainjector
    chart: cainjector-v0.8.1
    release: do
    heritage: Tiller
spec:
  replicas: 1
  selector:
    matchLabels:
      app: cainjector
      release: do
  template:
    metadata:
      labels:
        app: cainjector
        release: do
      annotations:
    spec:
      serviceAccountName: do-cainjector
      containers:
        - name: cainjector
          image: "quay.io/jetstack/cert-manager-cainjector:v0.8.1"
          imagePullPolicy: IfNotPresent
          args:
          - --v=2
          - --leader-election-namespace=$(POD_NAMESPACE)
          env:
          - name: POD_NAMESPACE
            valueFrom:
              fieldRef:
                fieldPath: metadata.namespace
          resources:
            {}
            

---
# Source: okteto-enterprise/charts/cert-manager/charts/webhook/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: do-webhook
  namespace: "okteto"
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller
spec:
  replicas: 1
  selector:
    matchLabels:
      app: webhook
      release: do
  template:
    metadata:
      labels:
        app: webhook
        release: do
      annotations:
    spec:
      serviceAccountName: do-webhook
      containers:
        - name: webhook
          image: "quay.io/jetstack/cert-manager-webhook:v0.8.1"
          imagePullPolicy: IfNotPresent
          args:
          - --v=2
          - --secure-port=6443
          - --tls-cert-file=/certs/tls.crt
          - --tls-private-key-file=/certs/tls.key
          env:
          - name: POD_NAMESPACE
            valueFrom:
              fieldRef:
                fieldPath: metadata.namespace
          resources:
            {}
            
          volumeMounts:
          - name: certs
            mountPath: /certs
      volumes:
      - name: certs
        secret:
          secretName: do-webhook-webhook-tls

---
# Source: okteto-enterprise/charts/cert-manager/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: do-cert-manager
  namespace: "okteto"
  labels:
    app: cert-manager
    chart: cert-manager-v0.8.1
    release: do
    heritage: Tiller
spec:
  replicas: 1
  selector:
    matchLabels:
      app: cert-manager
      release: do
  template:
    metadata:
      labels:
        app: cert-manager
        release: do
      annotations:
        prometheus.io/path: "/metrics"
        prometheus.io/scrape: 'true'
        prometheus.io/port: '9402'
    spec:
      serviceAccountName: do-cert-manager
      containers:
        - name: cert-manager
          image: "quay.io/jetstack/cert-manager-controller:v0.8.1"
          imagePullPolicy: IfNotPresent
          args:
          - --v=2
          - --cluster-resource-namespace=$(POD_NAMESPACE)
          - --leader-election-namespace=$(POD_NAMESPACE)
          ports:
          - containerPort: 9402
          env:
          - name: POD_NAMESPACE
            valueFrom:
              fieldRef:
                fieldPath: metadata.namespace
          resources:
            {}
            

---
# Source: okteto-enterprise/charts/nginx-ingress/templates/controller-deployment.yaml

apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    component: "controller"
    heritage: Tiller
    release: do
  name: do-nginx-ingress-controller
spec:
  replicas: 2
  selector:
    matchLabels:
      app: nginx-ingress
      component: "controller"
      release: do
  revisionHistoryLimit: 10
  strategy:
    {}
    
  minReadySeconds: 0
  template:
    metadata:
      labels:
        app: nginx-ingress
        component: "controller"
        release: do
    spec:
      dnsPolicy: ClusterFirst
      containers:
        - name: nginx-ingress-controller
          image: "quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.25.1"
          imagePullPolicy: "IfNotPresent"
          args:
            - /nginx-ingress-controller
            - --default-backend-service=okteto/do-nginx-ingress-default-backend
            - --election-id=ingress-controller-leader
            - --ingress-class=nginx
            - --configmap=okteto/do-nginx-ingress-controller
            - --default-ssl-certificate=$(POD_NAMESPACE)/default-ssl-certificate
          securityContext:
            capabilities:
                drop:
                - ALL
                add:
                - NET_BIND_SERVICE
            runAsUser: 33
            allowPrivilegeEscalation: true
          env:
            - name: POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: POD_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
          livenessProbe:
            httpGet:
              path: /healthz
              port: 10254
              scheme: HTTP
            initialDelaySeconds: 10
            periodSeconds: 10
            timeoutSeconds: 1
            successThreshold: 1
            failureThreshold: 3
          ports:
            - name: http
              containerPort: 80
              protocol: TCP
            - name: https
              containerPort: 443
              protocol: TCP
          readinessProbe:
            httpGet:
              path: /healthz
              port: 10254
              scheme: HTTP
            initialDelaySeconds: 10
            periodSeconds: 10
            timeoutSeconds: 1
            successThreshold: 1
            failureThreshold: 3
          resources:
            {}
            
      hostNetwork: false
      serviceAccountName: do-nginx-ingress
      terminationGracePeriodSeconds: 60

---
# Source: okteto-enterprise/charts/nginx-ingress/templates/default-backend-deployment.yaml

apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: nginx-ingress
    chart: nginx-ingress-1.16.0
    component: "default-backend"
    heritage: Tiller
    release: do
  name: do-nginx-ingress-default-backend
spec:
  replicas: 2
  selector:
    matchLabels:
      app: nginx-ingress
      component: "default-backend"
      release: do
  revisionHistoryLimit: 10
  template:
    metadata:
      labels:
        app: nginx-ingress
        component: "default-backend"
        release: do
    spec:
      containers:
        - name: nginx-ingress-default-backend
          image: "okteto/custom-error-pages:0.1.0"
          imagePullPolicy: "IfNotPresent"
          args:
          securityContext:
            runAsUser: 65534
          livenessProbe:
            httpGet:
              path: /healthz
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 3
          readinessProbe:
            httpGet:
              path: /healthz
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 0
            periodSeconds: 5
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          ports:
            - name: http
              containerPort: 8080
              protocol: TCP
          resources:
            {}
            
      terminationGracePeriodSeconds: 60

---
# Source: okteto-enterprise/templates/api-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: "do-okteto-enterprise-api"
  labels:
    app.kubernetes.io/component: "api"
    app.kubernetes.io/part-of: "okteto"
    app.kubernetes.io/name: "do-okteto-enterprise-api"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
spec:
  replicas: 2
  selector:
    matchLabels:
      app.kubernetes.io/name: "do-okteto-enterprise-api"
      app.kubernetes.io/instance: do
  template:
    metadata:
      labels:
        app.kubernetes.io/name: "do-okteto-enterprise-api"
        app.kubernetes.io/instance: do
        app.kubernetes.io/component: "api"
        app.kubernetes.io/part-of: "okteto"
      annotations:
        checksum/secrets: 804e6255cadd646fc2d99b806556e733574c2ef213adc8791d4d14896c6843b5
    spec:
      serviceAccountName: do-okteto-enterprise
      containers:
        - name: api
          image: "okteto/api:1.3.22"
          imagePullPolicy: Always
          ports:
            - name: http
              containerPort: 8080
              protocol: TCP
          env:
            - name: OKTETO_BASE_DOMAIN
              value: "local"
            - name: OKTETO_PUBLIC_URL
              value: "okteto.local"
            - name: OKTETO_MULTITENANCY_HARD
              value: "false"
            - name: OKTETO_DEV_CLUSTER_ROLE
              value: "do-okteto-enterprise-psp"
            - name: CLUSTER_PUBLIC_ENDPOINT
              value: ""
            - name: GITHUB_CLIENTID
              value: 
            - name: OKTETO_GITHUB_WHITELIST
              value: 
            - name: GITHUB_CLIENTSECRET
              valueFrom:
                secretKeyRef:
                  name: do-okteto-enterprise
                  key: githubClientSecret
          readinessProbe:
            httpGet:
              path: /healthz
              port: 8080
            initialDelaySeconds: 5
            periodSeconds: 5
          resources:
            {}
            
---
# Source: okteto-enterprise/templates/frontend-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: "do-okteto-enterprise-frontend"
  labels:
    app.kubernetes.io/component: "frontend"
    app.kubernetes.io/part-of: "okteto"
    app.kubernetes.io/name: "do-okteto-enterprise-frontend"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
spec:
  replicas: 2
  selector:
    matchLabels:
      app.kubernetes.io/name: "do-okteto-enterprise-frontend"
      app.kubernetes.io/instance: do
  template:
    metadata:
      labels:
        app.kubernetes.io/name: "do-okteto-enterprise-frontend"
        app.kubernetes.io/instance: do
        app.kubernetes.io/component: "frontend"
        app.kubernetes.io/part-of: "okteto"
    spec:
      serviceAccountName: do-okteto-enterprise
      containers:
        - name: frontend
          image: "okteto/frontend:1.3.22"
          imagePullPolicy: Always
          ports:
            - name: http
              containerPort: 8080
              protocol: TCP
          env:
            - name: GITHUB_CLIENTID
              value: 
          readinessProbe:
            httpGet:
              path: /index.html
              port: 8080
            initialDelaySeconds: 5
            periodSeconds: 5          
          resources:
            {}
            
---
# Source: okteto-enterprise/templates/webhook-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: "do-okteto-enterprise-mutation-webhook"
  labels:
    app.kubernetes.io/component: "webhook"
    app.kubernetes.io/part-of: "okteto"
    app.kubernetes.io/name: "do-okteto-enterprise-mutation-webhook"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
spec:
  replicas: 2
  selector:
    matchLabels:
      app.kubernetes.io/name: "do-okteto-enterprise-mutation-webhook"
      app.kubernetes.io/instance: do
  template:
    metadata:
      labels:
        app.kubernetes.io/name: "do-okteto-enterprise-mutation-webhook"
        app.kubernetes.io/instance: do
        app.kubernetes.io/component: "webhook"
        app.kubernetes.io/part-of: "okteto"
      annotations:
        checksum/secrets: f299b6962e1893cf253338c4e02647ae3f0bf2d3226c6d013a2c23ddfd78e51b
    spec:
      serviceAccountName: do-okteto-enterprise
      volumes:
        - name: webhook-tls-certs
          secret:
            defaultMode: 420
            secretName: "do-okteto-enterprise-mutation-webhook"
      containers:
        - name: server
          image: "okteto/webhook:1.3.22"
          imagePullPolicy: Always
          ports:
            - name: https
              containerPort: 8443
          env:
            - name: OKTETO_BASE_DOMAIN
              value: "local"
            - name: PORT
              value: "8443"
          volumeMounts:
            - name: webhook-tls-certs
              mountPath: /run/secrets/tls
              readOnly: true
          resources:
            {}
            
---
# Source: okteto-enterprise/templates/ingress.yaml
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: do-okteto-enterprise
  labels:
    app.kubernetes.io/name: okteto-enterprise
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
    app.kubernetes.io/part-of: "okteto"
  annotations:
    kubernetes.io/ingress.class: "nginx"
spec:
  tls:
  - hosts:
    - okteto.local
  rules:
    - host: okteto.local
      http:
        paths:
          - path: "/healthz"
            backend:
              serviceName: do-okteto-enterprise-api
              servicePort: 8080
          - path: "/github"
            backend:
              serviceName: do-okteto-enterprise-api
              servicePort: 8080
          - path: "/graphql"
            backend:
              serviceName: do-okteto-enterprise-api
              servicePort: 8080
          - path: "/auth"
            backend:
              serviceName: do-okteto-enterprise-api
              servicePort: 8080
          - path: "/"
            backend:
              serviceName: do-okteto-enterprise-frontend
              servicePort: 8080
---
# Source: okteto-enterprise/charts/cert-manager/charts/webhook/templates/apiservice.yaml
apiVersion: apiregistration.k8s.io/v1beta1
kind: APIService
metadata:
  name: v1beta1.admission.certmanager.k8s.io
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller
  annotations:
    certmanager.k8s.io/inject-ca-from: "okteto/do-webhook-webhook-tls"
spec:
  group: admission.certmanager.k8s.io
  groupPriorityMinimum: 1000
  versionPriority: 15
  service:
    name: do-webhook
    namespace: "okteto"
  version: v1beta1

---
# Source: okteto-enterprise/charts/cert-manager/charts/webhook/templates/pki.yaml
---
# Create a selfsigned Issuer, in order to create a root CA certificate for
# signing webhook serving certificates
apiVersion: certmanager.k8s.io/v1alpha1
kind: Issuer
metadata:
  name: do-webhook-selfsign
  namespace: "okteto"
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller
spec:
  selfSigned: {}

---

# Generate a CA Certificate used to sign certificates for the webhook
apiVersion: certmanager.k8s.io/v1alpha1
kind: Certificate
metadata:
  name: do-webhook-ca
  namespace: "okteto"
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller
spec:
  secretName: do-webhook-ca
  duration: 43800h # 5y
  issuerRef:
    name: do-webhook-selfsign
  commonName: "ca.webhook.cert-manager"
  isCA: true

---

# Create an Issuer that uses the above generated CA certificate to issue certs
apiVersion: certmanager.k8s.io/v1alpha1
kind: Issuer
metadata:
  name: do-webhook-ca
  namespace: "okteto"
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller
spec:
  ca:
    secretName: do-webhook-ca

---

# Finally, generate a serving certificate for the webhook to use
apiVersion: certmanager.k8s.io/v1alpha1
kind: Certificate
metadata:
  name: do-webhook-webhook-tls
  namespace: "okteto"
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller
spec:
  secretName: do-webhook-webhook-tls
  duration: 8760h # 1y
  issuerRef:
    name: do-webhook-ca
  dnsNames:
  - do-webhook
  - do-webhook.okteto
  - do-webhook.okteto.svc

---
# Source: okteto-enterprise/templates/certificate.yaml
apiVersion: certmanager.k8s.io/v1alpha1
kind: Issuer
metadata:
  name: do-okteto-enterprise
  labels:
    app.kubernetes.io/part-of: "okteto"
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email:  "admin@example.com"
    privateKeySecretRef:
      name: do-okteto-enterprise-letsencrypt
    dns01:
      providers:
        - name: okteto
          digitalocean:
            tokenSecretRef:
              name: okteto-dns
              key: key
---
apiVersion: certmanager.k8s.io/v1alpha1
kind: Certificate
metadata:
 name: default-ssl-certificate
 labels:
   app.kubernetes.io/part-of: "okteto"
spec:
 secretName: default-ssl-certificate
 issuerRef:
   name: do-okteto-enterprise
   kind: Issuer
 dnsNames:
   - "*.local"
 acme:
   config:
     - dns01:
         provider: okteto
       domains:
        - "*.local"
---
# Source: okteto-enterprise/templates/webhook.yaml


apiVersion: admissionregistration.k8s.io/v1beta1
kind: MutatingWebhookConfiguration
metadata:
  name: "do-okteto-enterprise-mutation-webhook"
  labels:
    app.kubernetes.io/name: "do-okteto-enterprise-mutation-webhook"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
webhooks:
  - name: ingress.webhook.okteto.com
    failurePolicy: Fail
    clientConfig:
      service:
        name: "do-okteto-enterprise-mutation-webhook"
        path: "/mutate/ingress"
        namespace: "okteto"
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM5RENDQWR5Z0F3SUJBZ0lRUEpaUy9LMjBTY2c0SGJTMjJTZ2llakFOQmdrcWhraUc5dzBCQVFzRkFEQVUKTVJJd0VBWURWUVFERXdsdmEzUmxkRzh0WTJFd0hoY05NVGt4TURJNU1UZ3hNelF5V2hjTk1qa3hNREkyTVRneApNelF5V2pBVU1SSXdFQVlEVlFRREV3bHZhM1JsZEc4dFkyRXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCCkR3QXdnZ0VLQW9JQkFRREtHS09RMUVrOCs1SjRqaVVNQ0U5eitRRzV4aG1yZFBRTDBRVlFpSkNtenpKeVQ4OWsKdERTWXZvM3ZVd1k2anpFUWJ2YlFFNElXRmFtNmJLa1J0TW9QM0ovUmk4RHFlbVR4NUVWeHBLdW9uNC9QUE5jTApXUHZlMjVxWE8zZ2xrSzh0aDRtbXhZY0V1N0t1bjAzaFA0QTF3Y0JLc3A4aUw1aTA0RnBJRUNURE1yc3pCa2puCjZMM2xWYkdwWjJ3QUxMQVhUdVA1SHRYc2o2VTkvYW14VzJNR3hqRmluSFpabTUrQjIybjRNMGpzRU1jMkZpTXcKZUFaeFJwbnl5a0doVUpCQjU5MjZBSkU2N3J4VG5iaFVlMzJoNEhnZXFxeDU1WWZFYlIwS3oxMEd3WVJTV2ZFdQpudHhUOHhXSEI2WjBxcTZmVzJSN0ZoVThMaFlvVFIzVUc0U2ZBZ01CQUFHalFqQkFNQTRHQTFVZER3RUIvd1FFCkF3SUNwREFkQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd0R3WURWUjBUQVFIL0JBVXcKQXdFQi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFIMjVLRENNeVBPR3ZOa2xxelVLdkxnaVpJMk5Sb2pxbQprYVMxOVp2L0pCODFRNzB4VnYzWFlJWVE4NExDbEc1WW5sMlU5ZDZRVlZlRWxUVHg4bnhuc3JCN2RuWUNFVjFDCk43ZU1DdVNqVis1T01qVjZGY0dTV0pHUmo0TTI3K3oyOG1lSTJ4VFQ1NTk1LzRtVC9aOEw4VEpaZEE1dk00UmgKdUJxSGNFZjZZdnJ3a2xWY1YzODM1RTA4Y0I4dC80bllkdlQ0eXhEdEljQ1dPVFdRQXljcDQ1aXNwT3RXSkhFcwpwOE5ielhpNkRZYlY5NTNrTUowQUVadFk1UDJyZzBnVkUySlA5ZlZOOU9NL2prb0NlcDdxeitpZXRkbzNJaSsrClVaaUZFaHMxYlJpdkFEUS9aenI2Rlo2aEtDZURzS2ZCdnVkQnhSSUQybzF5WFo5cFN4M25VZz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    rules:
      - operations: [ "CREATE", "UPDATE" ]
        apiGroups: ["extensions"]
        apiVersions: ["v1beta1"]
        resources: ["ingresses"]
    namespaceSelector:
      matchLabels:
        dev.okteto.com: "true"
  - name: service.webhook.okteto.com
    clientConfig:
      service:
        name: "do-okteto-enterprise-mutation-webhook"
        path: "/mutate/service"
        namespace: "okteto"
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM5RENDQWR5Z0F3SUJBZ0lRUEpaUy9LMjBTY2c0SGJTMjJTZ2llakFOQmdrcWhraUc5dzBCQVFzRkFEQVUKTVJJd0VBWURWUVFERXdsdmEzUmxkRzh0WTJFd0hoY05NVGt4TURJNU1UZ3hNelF5V2hjTk1qa3hNREkyTVRneApNelF5V2pBVU1SSXdFQVlEVlFRREV3bHZhM1JsZEc4dFkyRXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCCkR3QXdnZ0VLQW9JQkFRREtHS09RMUVrOCs1SjRqaVVNQ0U5eitRRzV4aG1yZFBRTDBRVlFpSkNtenpKeVQ4OWsKdERTWXZvM3ZVd1k2anpFUWJ2YlFFNElXRmFtNmJLa1J0TW9QM0ovUmk4RHFlbVR4NUVWeHBLdW9uNC9QUE5jTApXUHZlMjVxWE8zZ2xrSzh0aDRtbXhZY0V1N0t1bjAzaFA0QTF3Y0JLc3A4aUw1aTA0RnBJRUNURE1yc3pCa2puCjZMM2xWYkdwWjJ3QUxMQVhUdVA1SHRYc2o2VTkvYW14VzJNR3hqRmluSFpabTUrQjIybjRNMGpzRU1jMkZpTXcKZUFaeFJwbnl5a0doVUpCQjU5MjZBSkU2N3J4VG5iaFVlMzJoNEhnZXFxeDU1WWZFYlIwS3oxMEd3WVJTV2ZFdQpudHhUOHhXSEI2WjBxcTZmVzJSN0ZoVThMaFlvVFIzVUc0U2ZBZ01CQUFHalFqQkFNQTRHQTFVZER3RUIvd1FFCkF3SUNwREFkQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd0R3WURWUjBUQVFIL0JBVXcKQXdFQi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFIMjVLRENNeVBPR3ZOa2xxelVLdkxnaVpJMk5Sb2pxbQprYVMxOVp2L0pCODFRNzB4VnYzWFlJWVE4NExDbEc1WW5sMlU5ZDZRVlZlRWxUVHg4bnhuc3JCN2RuWUNFVjFDCk43ZU1DdVNqVis1T01qVjZGY0dTV0pHUmo0TTI3K3oyOG1lSTJ4VFQ1NTk1LzRtVC9aOEw4VEpaZEE1dk00UmgKdUJxSGNFZjZZdnJ3a2xWY1YzODM1RTA4Y0I4dC80bllkdlQ0eXhEdEljQ1dPVFdRQXljcDQ1aXNwT3RXSkhFcwpwOE5ielhpNkRZYlY5NTNrTUowQUVadFk1UDJyZzBnVkUySlA5ZlZOOU9NL2prb0NlcDdxeitpZXRkbzNJaSsrClVaaUZFaHMxYlJpdkFEUS9aenI2Rlo2aEtDZURzS2ZCdnVkQnhSSUQybzF5WFo5cFN4M25VZz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    rules:
      - operations: [ "CREATE", "UPDATE", "DELETE"]
        apiGroups: [""]
        apiVersions: ["v1"]
        resources: ["services"]
    namespaceSelector:
      matchLabels:
        dev.okteto.com: "true"
  - name: pod.webhook.okteto.com
    clientConfig:
      service:
        name: "do-okteto-enterprise-mutation-webhook"
        path: "/mutate/pod"
        namespace: "okteto"
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM5RENDQWR5Z0F3SUJBZ0lRUEpaUy9LMjBTY2c0SGJTMjJTZ2llakFOQmdrcWhraUc5dzBCQVFzRkFEQVUKTVJJd0VBWURWUVFERXdsdmEzUmxkRzh0WTJFd0hoY05NVGt4TURJNU1UZ3hNelF5V2hjTk1qa3hNREkyTVRneApNelF5V2pBVU1SSXdFQVlEVlFRREV3bHZhM1JsZEc4dFkyRXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCCkR3QXdnZ0VLQW9JQkFRREtHS09RMUVrOCs1SjRqaVVNQ0U5eitRRzV4aG1yZFBRTDBRVlFpSkNtenpKeVQ4OWsKdERTWXZvM3ZVd1k2anpFUWJ2YlFFNElXRmFtNmJLa1J0TW9QM0ovUmk4RHFlbVR4NUVWeHBLdW9uNC9QUE5jTApXUHZlMjVxWE8zZ2xrSzh0aDRtbXhZY0V1N0t1bjAzaFA0QTF3Y0JLc3A4aUw1aTA0RnBJRUNURE1yc3pCa2puCjZMM2xWYkdwWjJ3QUxMQVhUdVA1SHRYc2o2VTkvYW14VzJNR3hqRmluSFpabTUrQjIybjRNMGpzRU1jMkZpTXcKZUFaeFJwbnl5a0doVUpCQjU5MjZBSkU2N3J4VG5iaFVlMzJoNEhnZXFxeDU1WWZFYlIwS3oxMEd3WVJTV2ZFdQpudHhUOHhXSEI2WjBxcTZmVzJSN0ZoVThMaFlvVFIzVUc0U2ZBZ01CQUFHalFqQkFNQTRHQTFVZER3RUIvd1FFCkF3SUNwREFkQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd0R3WURWUjBUQVFIL0JBVXcKQXdFQi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFIMjVLRENNeVBPR3ZOa2xxelVLdkxnaVpJMk5Sb2pxbQprYVMxOVp2L0pCODFRNzB4VnYzWFlJWVE4NExDbEc1WW5sMlU5ZDZRVlZlRWxUVHg4bnhuc3JCN2RuWUNFVjFDCk43ZU1DdVNqVis1T01qVjZGY0dTV0pHUmo0TTI3K3oyOG1lSTJ4VFQ1NTk1LzRtVC9aOEw4VEpaZEE1dk00UmgKdUJxSGNFZjZZdnJ3a2xWY1YzODM1RTA4Y0I4dC80bllkdlQ0eXhEdEljQ1dPVFdRQXljcDQ1aXNwT3RXSkhFcwpwOE5ielhpNkRZYlY5NTNrTUowQUVadFk1UDJyZzBnVkUySlA5ZlZOOU9NL2prb0NlcDdxeitpZXRkbzNJaSsrClVaaUZFaHMxYlJpdkFEUS9aenI2Rlo2aEtDZURzS2ZCdnVkQnhSSUQybzF5WFo5cFN4M25VZz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    rules:
      - operations: [ "CREATE"]
        apiGroups: [""]
        apiVersions: ["v1"]
        resources: ["pods"]
    namespaceSelector:
      matchLabels:
        dev.okteto.com: "true"
---
apiVersion: v1
kind: Secret
metadata:
  name: "do-okteto-enterprise-mutation-webhook"
  labels:
    app.kubernetes.io/name: "do-okteto-enterprise-mutation-webhook"
    helm.sh/chart: okteto-enterprise-0.2.13
    app.kubernetes.io/instance: do
    app.kubernetes.io/managed-by: Tiller
type: Opaque
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURlakNDQW1LZ0F3SUJBZ0lRT3F1RE83N3dDZGgwUXJYaHRQVDlCekFOQmdrcWhraUc5dzBCQVFzRkFEQVUKTVJJd0VBWURWUVFERXdsdmEzUmxkRzh0WTJFd0hoY05NVGt4TURJNU1UZ3hNelF5V2hjTk1qa3hNREkyTVRneApNelF5V2pBd01TNHdMQVlEVlFRREV5VmtieTF2YTNSbGRHOHRaVzUwWlhKd2NtbHpaUzF0ZFhSaGRHbHZiaTEzClpXSm9iMjlyTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUF0TFJVQUFUd2RRTDMKSG1BNTVMTVZSMG1YZS9EdytIcEVsd2Y4RlY5SWNFQk53RkpicjFWT1IxUVFkdzVEY1ZJTDV6T0g0UktHajdlRAo2dmlBWTM2ZHZHTkRobTFIb1JLdFVvWXlHNlEwdjdGQ01QckN6OTlDYSt6V09kcFU4OWE5QjlNQmYxcklCTWx5CnBrY01nb3FKaXU2VCtJQmhyNUNHT1NwY1N2NVdSb2RoZExjSjVKWFFZaW9iSUFGdDQ4MEZJazBOMTdJUWpjbncKckhTQTdiZFZCL0NDc2VSYnBxc0ZkWjd2QzkzYWIwaXA3ei96SnAxV3hiU0hWeXpFTTM1S0JISnBjVHFLcDJKZwphSG13MFdvR2Q4UTd4WXpPWk1yUnc1bnVuSDFjYTgzejZpaGV4NE50dEpHSUdHbEZGVGNMRjg3OUZyU2s3RUpvCnMzU29VY05wT3dJREFRQUJvNEdyTUlHb01BNEdBMVVkRHdFQi93UUVBd0lGb0RBZEJnTlZIU1VFRmpBVUJnZ3IKQmdFRkJRY0RBUVlJS3dZQkJRVUhBd0l3REFZRFZSMFRBUUgvQkFJd0FEQnBCZ05WSFJFRVlqQmdnaXhrYnkxdgphM1JsZEc4dFpXNTBaWEp3Y21selpTMXRkWFJoZEdsdmJpMTNaV0pvYjI5ckxtOXJkR1YwYjRJd1pHOHRiMnQwClpYUnZMV1Z1ZEdWeWNISnBjMlV0YlhWMFlYUnBiMjR0ZDJWaWFHOXZheTV2YTNSbGRHOHVjM1pqTUEwR0NTcUcKU0liM0RRRUJDd1VBQTRJQkFRQkFFQ3A0eXlzeWxteVQrMXhqUzNHZ1lIS3VzcTBrRnF4aXhkYWZsaXM0bURtUwpFNVIrRDB2dW5wT0czNzlaMGlLR2hicmdrRG5RalNadW5ZWWdRc2xITHl1T2F1dkJoZXpnSW9mWDJZNzFCQUhCClJUUUh4czZ6WDAxaTZJVnZMWnBwYUxCZVUrMytUcC9OcElFR2FrTGFtTElwc29aTU9ESjBwSWJ2Tkt6Vm1oVHAKTmIrUlhGejNocXlrMlJYMmNkSWlpeFVVa2JURk5SL0tCOEtCL0c1Slh2ZXhUVFk3WXFhSDI3UWZiV1RZblBHSQoyR0VnU2NreWM2bjlOZHN0VXJZckRCRTNoNiswdDJGTzB0STlpblJyTW40Ukl4THYwaklHRHVmR1g4WlhobVB0Cm5OME1FNkxFOGU3SU9kbk9QQWdBM2diVGpjS2ZLMUxYaVBoRVRJRU0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBdExSVUFBVHdkUUwzSG1BNTVMTVZSMG1YZS9EdytIcEVsd2Y4RlY5SWNFQk53RkpiCnIxVk9SMVFRZHc1RGNWSUw1ek9INFJLR2o3ZUQ2dmlBWTM2ZHZHTkRobTFIb1JLdFVvWXlHNlEwdjdGQ01QckMKejk5Q2EreldPZHBVODlhOUI5TUJmMXJJQk1seXBrY01nb3FKaXU2VCtJQmhyNUNHT1NwY1N2NVdSb2RoZExjSgo1SlhRWWlvYklBRnQ0ODBGSWswTjE3SVFqY253ckhTQTdiZFZCL0NDc2VSYnBxc0ZkWjd2QzkzYWIwaXA3ei96CkpwMVd4YlNIVnl6RU0zNUtCSEpwY1RxS3AySmdhSG13MFdvR2Q4UTd4WXpPWk1yUnc1bnVuSDFjYTgzejZpaGUKeDROdHRKR0lHR2xGRlRjTEY4NzlGclNrN0VKb3MzU29VY05wT3dJREFRQUJBb0lCQVFDS1VRMkxCanpZRS9ENwp1MFFWSGs3SFJqbEJrV2VoaWxVK0ZjcUt3V2c5STd0ZjNxcDNScUNvVUZ4YUJQenluSTZuNWZXMy9lb3B6NXFXCkhLaUpmNzFWR2RYeDYydk1pdk5JRzVmM09IVjMxVUtKSXloQzNPMkdscjVUZ2g5TWxhNFRjeHZPVTdxT2ozUEcKZXRQRWlDNUh2ZDVkZEVkUmp4cHVYMUpOeE9oZENySEY0S1dtU1lQSzYwNzAyaVUveXFNQ2RBV1N3cyt0S00rUQorY1F6VUJrbXVBOWlUTjhQOGYybVBvbDlQcE11WlQxSE5FYzlCOWlobHVzQkszandyQjhRdVZaR2d6U3dlQ0phClJPWkxtV29XajVPNUhFc08yRTdQZHUrNXpqTW5pajJac2ZzUEVyYmhuMEhVMnFXK2JzZUZNbVhtQWlTYkdXWFoKcWtxcjlBcEJBb0dCQU41NmZ6RDNlYVQ1bkF4b0tNTXNXb09wUy9XWFZJd2NuTDQ1YmJQejJGQzB6RXJaNDZQNwpuemp4NmlxYUIwM3pkQ1VuaGk2ekJhSzhrSWt2dUduRXZsVW1UZFFEUWpyYmQzY1dSeTA2QTlLVUxPUGZPUGc2ClROaVlhVnhWcWdVbGV2YXVBcC9ubWdDaWpzOVRwQXJSdGpHQzh4aVhLMFBlblZRbGhOdnJzc3lEQW9HQkFNL3UKZ2xaRWl4cVYrb0NmUTIvUXFIRnhYKzhBdkdKK3oxckd3UXNXWXZ3ZjhIc1NnVnAvdEMyT2tKNENEbENsNjNHMgpUaTJjNUpILzlQKzV1TVJhN0dCcmRkcG44TWlLbDNnSmJicTVlRmRkOVhvRzNhVHA2SS9SY2ZBbkNGbEVMSGJHClNOOWpJMk9lRGJvbitiSSsvVWNqYnkxa0h5Z2RieTljam95SkJNTHBBb0dCQUlIeUhLNTJMZGY5YjNjVHM1TmsKS2E0elNVbTJUVXpWUFh3aVFRQlYwaWc1b2dXcVJMczRNaVRwci9PWUtlSU82K3p6cS8xRTFXcmJKclRxYVpWbAp0Q0k2RUVWZ2JlUEE0b050UUwrYTNqYTJFNDQ1aUtYOEwzeG5jVXJjUWtWbFFmQXBiU0VHL3IyV05VSEZ3ZEFMCjg1WHh2Wm5FV2lIM09mKzNObVhad29LUEFvR0FPL0xwRXhRNkF0VkEzdnFNQjkzaDRxc3NYSTBhdzA4S1c0SzQKUDRrWnl0VXVrVjA1ZkMwYmRwTUc4UGRveHltL0l3N0xwV3o1blhwdFdabGpRd0Z2NnpDd1R1THUwZkxiVHRseApFSWZPd1dtdWo1c1JKaTNtUmlpOXI5NmhFcE9NT2taYTFrVVArL1dpd1l3cStwQWNsL2tJWWM3ZkNNTEx2cHp4CjRHVFV3WmtDZ1lCZWNmNXU2SXNRQktUMlVzWjFLdDNGdzJicmRsamJSUHZqeXRGUzY5RjVNaEF5WVFrdXpUUUsKZlVjanFuTVRBZzkxT09HS2hPaUhCOUV4RE1tQ2xub3ppYVVtSkRQbzhtclExVHRYdjBjTGtSaElKVnJxaEpuUQpib1NDRnlwQ3FGQnpjcEdnWlRGQnI2dDJVUVcweDIvVHNnTzVCZ0ppTS9ETmttUitWSHY3NEE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
---
# Source: okteto-enterprise/charts/nginx-ingress/templates/addheaders-configmap.yaml


---
# Source: okteto-enterprise/charts/nginx-ingress/templates/controller-daemonset.yaml


---
# Source: okteto-enterprise/charts/nginx-ingress/templates/controller-hpa.yaml


---
# Source: okteto-enterprise/charts/nginx-ingress/templates/controller-metrics-service.yaml


---
# Source: okteto-enterprise/charts/nginx-ingress/templates/controller-prometheusrules.yaml


---
# Source: okteto-enterprise/charts/nginx-ingress/templates/controller-servicemonitor.yaml


---
# Source: okteto-enterprise/charts/nginx-ingress/templates/podsecuritypolicy.yaml


---
# Source: okteto-enterprise/charts/nginx-ingress/templates/proxyheaders-configmap.yaml


---
# Source: okteto-enterprise/charts/nginx-ingress/templates/tcp-configmap.yaml


---
# Source: okteto-enterprise/charts/nginx-ingress/templates/udp-configmap.yaml


---
# Source: okteto-enterprise/charts/cert-manager/charts/webhook/templates/validating-webhook.yaml
apiVersion: admissionregistration.k8s.io/v1beta1
kind: ValidatingWebhookConfiguration
metadata:
  name: do-webhook
  labels:
    app: webhook
    chart: webhook-v0.8.1
    release: do
    heritage: Tiller
  annotations:
    certmanager.k8s.io/inject-apiserver-ca: "true"
webhooks:
  - name: certificates.admission.certmanager.k8s.io
    namespaceSelector:
      matchExpressions:
      - key: "certmanager.k8s.io/disable-validation"
        operator: "NotIn"
        values:
        - "true"
      - key: "name"
        operator: "NotIn"
        values:
        - okteto
    rules:
      - apiGroups:
          - "certmanager.k8s.io"
        apiVersions:
          - v1alpha1
        operations:
          - CREATE
          - UPDATE
        resources:
          - certificates
    failurePolicy: Fail
    clientConfig:
      service:
        name: kubernetes
        namespace: default
        path: /apis/admission.certmanager.k8s.io/v1beta1/certificates
  - name: issuers.admission.certmanager.k8s.io
    namespaceSelector:
      matchExpressions:
      - key: "certmanager.k8s.io/disable-validation"
        operator: "NotIn"
        values:
        - "true"
      - key: "name"
        operator: "NotIn"
        values:
        - okteto
    rules:
      - apiGroups:
          - "certmanager.k8s.io"
        apiVersions:
          - v1alpha1
        operations:
          - CREATE
          - UPDATE
        resources:
          - issuers
    failurePolicy: Fail
    clientConfig:
      service:
        name: kubernetes
        namespace: default
        path: /apis/admission.certmanager.k8s.io/v1beta1/issuers
  - name: clusterissuers.admission.certmanager.k8s.io
    namespaceSelector:
      matchExpressions:
      - key: "certmanager.k8s.io/disable-validation"
        operator: "NotIn"
        values:
        - "true"
      - key: "name"
        operator: "NotIn"
        values:
        - okteto
    rules:
      - apiGroups:
          - "certmanager.k8s.io"
        apiVersions:
          - v1alpha1
        operations:
          - CREATE
          - UPDATE
        resources:
          - clusterissuers
    failurePolicy: Fail
    clientConfig:
      service:
        name: kubernetes
        namespace: default
        path: /apis/admission.certmanager.k8s.io/v1beta1/clusterissuers

